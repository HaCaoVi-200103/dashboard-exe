import{b as S,r,j as e,c as _}from"./index-CWsHuDg1.js";import{M as b,f as F,h as k,c as A,T as O,d as T,P as w,e as z,j as v,k as R}from"./category-7SLjgCxN.js";import{F as y,I as P,s as M}from"./customize-DygtvFNV.js";import{B as D}from"./index-CcNt1mtI.js";import"./index-BrRgDCrU.js";const E=i=>{const{isCreateModalOpen:a,setIsCreateModalOpen:t}=i,{refreshProduct:u,setRefreshProduct:f,refreshCategory:p,setRefreshCategory:n}=S(),[o]=y.useForm(),[c,s]=r.useState(!1),l=()=>{o.resetFields(),s(!1),t(!1)},m=async d=>{s(!0);const g=await F(d.cate_name);if(g.statusCode===201){M.success({message:g.message}),s(!1),o.resetFields(),f(!u),n(!p),t(!1);return}};return e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:a,onOk:()=>o.submit(),onCancel:()=>l(),maskClosable:!1,loading:c,children:e.jsx(y,{name:"basic",onFinish:m,layout:"vertical",form:o,children:e.jsx(y.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(P,{})})})})})},U=i=>{const{isUpdateModalOpen:a,dataCate:t,setIsUpdateModalOpen:u}=i,{refreshCategory:f,setRefreshCategory:p}=S(),[n]=y.useForm(),[o,c]=r.useState(!1),s=()=>{n.resetFields(),c(!1),u(!1)},l=async m=>{c(!0);const d=await k(t._id,m.cate_name);if(d.statusCode===200){M.success({message:d.message}),c(!1),n.resetFields(),p(!f),u(!1);return}};return r.useEffect(()=>{n.setFieldValue("cate_name",t==null?void 0:t.cate_name)},[a,t]),e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:a,onOk:()=>n.submit(),onCancel:()=>s(),maskClosable:!1,loading:o,children:e.jsx(y,{name:"basic",onFinish:l,layout:"vertical",form:n,children:e.jsx(y.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(P,{})})})})})},L=i=>{const{dataSource:a,meta:t}=i,[u,f]=r.useState(a),[p,n]=r.useState(t),[o,c]=r.useState(!1),[s,l]=r.useState(!1),[m,d]=r.useState(null),{refreshProduct:g,setRefreshProduct:h}=S();r.useEffect(()=>{(async()=>(n(t),f(a)))()},[a,t]);const x=async I=>{const C=await v(I);C.statusCode===200&&(h(!g),M.success({message:C.message}))},j=[{title:"Name",dataIndex:"cate_name",key:"pro_name"},{title:"Product",dataIndex:"product_count",key:"pro_picture",render:I=>e.jsx("div",{children:I})},{title:"Action",dataIndex:"is_deleted",key:"is_deleted",render:(I,C)=>e.jsxs("div",{style:{display:"flex",gap:20,justifyContent:"start"},children:[e.jsx(T,{style:{fontSize:20},onClick:()=>{l(!0),d(C)}}),e.jsx(w,{title:"Are you sure delete category?",onConfirm:()=>x(C._id),cancelText:"No",children:e.jsx(z,{style:{fontSize:20},twoToneColor:"#F04770"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,fontWeight:600,fontSize:20},children:[e.jsx("span",{children:"Manage Category"}),e.jsxs(D,{onClick:()=>c(!0),children:[e.jsx(A,{}),e.jsx("span",{children:"Add New"})]})]}),e.jsx(O,{columns:j,dataSource:u,meta:p}),e.jsx(E,{isCreateModalOpen:o,setIsCreateModalOpen:c}),e.jsx(U,{dataCate:m,isUpdateModalOpen:s,setIsUpdateModalOpen:l})]})},W=()=>{const[i]=_(),a=i.get("current")||"1",t=i.get("pageSize")||"5",[u,f]=r.useState([]),[p,n]=r.useState({current:1,pageSize:10,total:1}),{refreshProduct:o}=S();return r.useEffect(()=>{(async()=>{var l,m,d,g,h,x,j;const s=await R(+a,+t);f(((l=s.data)==null?void 0:l.result)||[]),n({current:((d=(m=s.data)==null?void 0:m.meta)==null?void 0:d.current)||1,pageSize:((h=(g=s.data)==null?void 0:g.meta)==null?void 0:h.pageSize)||10,total:((j=(x=s.data)==null?void 0:x.meta)==null?void 0:j.total)||1})})()},[a,t,o]),e.jsx("div",{children:e.jsx(L,{metaDefault:{current:+a,LIMIT:+t},dataSource:u||[],meta:p})})};export{W as default};
