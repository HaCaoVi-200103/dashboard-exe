import{b as M,r,j as e,c as _}from"./index-DI-zLvHu.js";import{M as b,f as F,h as k,c as A,T as O,d as T,P as w,e as z,j as v,k as R}from"./category-8wF75CT3.js";import{F as C,I as P,s as x}from"./customize-CmDwwPA0.js";import{B as D}from"./index-aAq_jmL9.js";import"./index-Dnc8NmWI.js";const E=u=>{const{isCreateModalOpen:s,setIsCreateModalOpen:t}=u,{refreshProduct:m,setRefreshProduct:y,refreshCategory:h,setRefreshCategory:o}=M(),[n]=C.useForm(),[d,c]=r.useState(!1),i=()=>{n.resetFields(),c(!1),t(!1)},f=async a=>{c(!0);try{const l=await F(a.cate_name);if(l.statusCode===201){x.success({message:l.message}),c(!1),n.resetFields(),y(!m),o(!h),t(!1);return}x.error({message:l.message})}catch(l){console.log(l)}};return e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:s,onOk:()=>n.submit(),onCancel:()=>i(),maskClosable:!1,loading:d,children:e.jsx(C,{name:"basic",onFinish:f,layout:"vertical",form:n,children:e.jsx(C.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(P,{})})})})})},U=u=>{const{isUpdateModalOpen:s,dataCate:t,setIsUpdateModalOpen:m}=u,{refreshCategory:y,setRefreshCategory:h}=M(),[o]=C.useForm(),[n,d]=r.useState(!1),c=()=>{o.resetFields(),d(!1),m(!1)},i=async f=>{d(!0);try{const a=await k(t._id,f.cate_name);if(a.statusCode===200){x.success({message:a.message}),d(!1),o.resetFields(),h(!y),m(!1);return}x.error({message:a.message})}catch(a){console.log(a)}};return r.useEffect(()=>{o.setFieldValue("cate_name",t==null?void 0:t.cate_name)},[s,t]),e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:s,onOk:()=>o.submit(),onCancel:()=>c(),maskClosable:!1,loading:n,children:e.jsx(C,{name:"basic",onFinish:i,layout:"vertical",form:o,children:e.jsx(C.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(P,{})})})})})},L=u=>{const{dataSource:s,meta:t}=u,[m,y]=r.useState(s),[h,o]=r.useState(t),[n,d]=r.useState(!1),[c,i]=r.useState(!1),[f,a]=r.useState(null),{refreshProduct:l,setRefreshProduct:j}=M();r.useEffect(()=>{(async()=>(o(t),y(s)))()},[s,t]);const I=async S=>{try{const p=await v(S);if(p.statusCode===200){j(!l),x.success({message:p.message});return}x.error({message:p.message})}catch(p){console.log(p)}},g=[{title:"Name",dataIndex:"cate_name",key:"pro_name"},{title:"Product",dataIndex:"product_count",key:"pro_picture",render:S=>e.jsx("div",{children:S})},{title:"Action",dataIndex:"is_deleted",key:"is_deleted",render:(S,p)=>e.jsxs("div",{style:{display:"flex",gap:20,justifyContent:"start"},children:[e.jsx(T,{style:{fontSize:20},onClick:()=>{i(!0),a(p)}}),e.jsx(w,{title:"Are you sure delete category?",onConfirm:()=>I(p._id),cancelText:"No",children:e.jsx(z,{style:{fontSize:20},twoToneColor:"#F04770"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,fontWeight:600,fontSize:20},children:[e.jsx("span",{children:"Manage Category"}),e.jsxs(D,{onClick:()=>d(!0),children:[e.jsx(A,{}),e.jsx("span",{children:"Add New"})]})]}),e.jsx(O,{columns:g,dataSource:m,meta:h}),e.jsx(E,{isCreateModalOpen:n,setIsCreateModalOpen:d}),e.jsx(U,{dataCate:f,isUpdateModalOpen:c,setIsUpdateModalOpen:i})]})},W=()=>{const[u]=_(),s=u.get("current")||"1",t=u.get("pageSize")||"5",[m,y]=r.useState([]),[h,o]=r.useState({current:1,pageSize:10,total:1}),{refreshProduct:n}=M();return r.useEffect(()=>{(async()=>{var c,i,f,a,l,j,I;try{const g=await R(+s,+t);y(((c=g.data)==null?void 0:c.result)||[]),o({current:((f=(i=g.data)==null?void 0:i.meta)==null?void 0:f.current)||1,pageSize:((l=(a=g.data)==null?void 0:a.meta)==null?void 0:l.pageSize)||10,total:((I=(j=g.data)==null?void 0:j.meta)==null?void 0:I.total)||1})}catch(g){console.log(g)}})()},[s,t,n]),e.jsx("div",{children:e.jsx(L,{metaDefault:{current:+s,LIMIT:+t},dataSource:m||[],meta:h})})};export{W as default};
