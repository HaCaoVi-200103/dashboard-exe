import{v as M,r as s,j as e,x as F}from"./index-CqkrYb4u.js";import{M as b,R as k,T as P,a as w,P as A,b as O}from"./index-rvcLEq5v.js";import{c as T,u as v,d as z,a as R}from"./category-CZPHhT5R.js";import{F as x,I as _,s as h}from"./customize-CACpNBRU.js";import{B as D}from"./index-BHPA9aJO.js";import{S as E}from"./Skeleton-CU0d_ayr.js";import"./index-ov-qCStI.js";import"./CloseOutlined-Dz1priRJ.js";import"./index-CXjsHQYd.js";import"./index-Dt8VRAac.js";const L=u=>{const{isCreateModalOpen:r,setIsCreateModalOpen:t}=u,{refreshProduct:m,setRefreshProduct:f,refreshCategory:p,setRefreshCategory:n}=M(),[c]=x.useForm(),[l,d]=s.useState(!1),y=()=>{c.resetFields(),d(!1),t(!1)},g=async o=>{d(!0);try{const i=await T(o.cate_name);if(i.statusCode===201){h.success({message:i.message}),d(!1),c.resetFields(),f(!m),n(!p),t(!1);return}h.error({message:i.message})}catch(i){console.log(i)}};return e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:r,onOk:()=>c.submit(),onCancel:()=>y(),maskClosable:!1,loading:l,children:e.jsx(x,{name:"basic",onFinish:g,layout:"vertical",form:c,children:e.jsx(x.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(_,{})})})})})},U=u=>{const{isUpdateModalOpen:r,dataCate:t,setIsUpdateModalOpen:m}=u,{refreshCategory:f,setRefreshCategory:p}=M(),[n]=x.useForm(),[c,l]=s.useState(!1),d=()=>{n.resetFields(),l(!1),m(!1)},y=async g=>{l(!0);try{const o=await v(t._id,g.cate_name);if(o.statusCode===200){h.success({message:o.message}),l(!1),n.resetFields(),p(!f),m(!1);return}h.error({message:o.message})}catch(o){console.log(o)}};return s.useEffect(()=>{n.setFieldValue("cate_name",t==null?void 0:t.cate_name)},[r,t]),e.jsx("div",{children:e.jsx(b,{style:{top:50},title:"Add new product",open:r,onOk:()=>n.submit(),onCancel:()=>d(),maskClosable:!1,loading:c,children:e.jsx(x,{name:"basic",onFinish:y,layout:"vertical",form:n,children:e.jsx(x.Item,{hasFeedback:!0,label:"Category name",name:"cate_name",rules:[{required:!0,message:"Please input your category name!"}],children:e.jsx(_,{})})})})})},B=u=>{const{dataSource:r,meta:t}=u,[m,f]=s.useState(r),[p,n]=s.useState(t),[c,l]=s.useState(!1),[d,y]=s.useState(!1),[g,o]=s.useState(null),{refreshCategory:i,setRefreshCategory:j}=M();s.useEffect(()=>{(async()=>(n(t),f(r)))()},[r,t]);const S=async C=>{try{const a=await z(C);if(a.statusCode===200){j(!i),h.success({message:a.message});return}h.error({message:a.message})}catch(a){console.log(a)}},I=[{title:"Name",dataIndex:"cate_name",key:"pro_name"},{title:"Product",dataIndex:"product_count",key:"pro_picture",render:C=>e.jsx("div",{children:C})},{title:"Action",dataIndex:"is_deleted",key:"is_deleted",render:(C,a)=>e.jsxs("div",{style:{display:"flex",gap:20,justifyContent:"start"},children:[e.jsx(w,{style:{fontSize:20},onClick:()=>{y(!0),o(a)}}),e.jsx(A,{title:"Are you sure delete category?",onConfirm:()=>S(a._id),cancelText:"No",children:e.jsx(O,{style:{fontSize:20},twoToneColor:"#F04770"})})]})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,fontWeight:600,fontSize:20},children:[e.jsx("span",{children:"Manage Category"}),e.jsxs(D,{onClick:()=>l(!0),children:[e.jsx(k,{}),e.jsx("span",{children:"Add New"})]})]}),e.jsx(P,{columns:I,dataSource:m,meta:p}),e.jsx(L,{isCreateModalOpen:c,setIsCreateModalOpen:l}),e.jsx(U,{dataCate:g,isUpdateModalOpen:d,setIsUpdateModalOpen:y})]})},X=()=>{const[u]=F(),r=u.get("current")||"1",t=u.get("pageSize")||"5",[m,f]=s.useState([]),[p,n]=s.useState({current:1,pageSize:10,total:1}),{refreshCategory:c}=M(),[l,d]=s.useState(!1);return s.useEffect(()=>{(async()=>{var g,o,i,j,S,I,C;try{d(!0);const a=await R(+r,+t);if(d(!1),a.statusCode!==200)return h.warning({message:"Can't take data category"});f(((g=a.data)==null?void 0:g.result)||[]),n({current:((i=(o=a.data)==null?void 0:o.meta)==null?void 0:i.current)||1,pageSize:((S=(j=a.data)==null?void 0:j.meta)==null?void 0:S.pageSize)||10,total:((C=(I=a.data)==null?void 0:I.meta)==null?void 0:C.total)||1})}catch(a){console.log(a)}})()},[r,t,c]),l?e.jsx(E,{}):e.jsx("div",{children:e.jsx(B,{metaDefault:{current:+r,LIMIT:+t},dataSource:m||[],meta:p})})};export{X as default};
